/*!
 * CSS Modal
 * http://drublic.github.com/css-modal
 *
 * @author Hans Christian Reinl - @drublic
 * @version 1.1.0alpha
 */
!function(e){"use strict";var t={activeElement:void 0,lastActive:void 0,stackedElements:[],tabbableElements:"a[href], area[href], input:not([disabled]),select:not([disabled]), textarea:not([disabled]),button:not([disabled]), iframe, object, embed, *[tabindex],*[contenteditable]",on:function(e,t,a){if("string"!=typeof e)throw new Error("Type error: `error` has to be a string");if("function"!=typeof a)throw new Error("Type error: `callback` has to be a function");t.addEventListener?t.addEventListener(e,a,!1):t.attachEvent("on"+e,a)},trigger:function(e,t){var a;window.CustomEvent&&(a=new CustomEvent(e,{detail:{modal:t}}),document.dispatchEvent(a))},addClass:function(e,t){e&&!e.className.match(t)&&(e.className+=" "+t)},removeClass:function(e,t){e.className=e.className.replace(t,"").replace("  "," ")},setFocus:function(){t.activeElement&&(t.lastActive=document.activeElement,t.activeElement.focus(),t.keepFocus(t.activeElement))},removeFocus:function(){t.lastActive&&t.lastActive.focus()},keepFocus:function(e){var a=e.querySelectorAll(t.tabbableElements),n=a[0],i=a[a.length-1],o=function(e){var t=e.which||e.keyCode;9===t&&(e.preventDefault=e.preventDefault||function(){e.returnValue=!1},e.target!==i||e.shiftKey?e.target===n&&e.shiftKey&&(e.preventDefault(),i.focus()):(e.preventDefault(),n.focus()))};t.on("keydown",e,o)},setActive:function(e){t.addClass(e,"is-active"),t.activeElement=e,t.activeElement.setAttribute("aria-hidden","false"),t.setFocus(e.id),t.trigger("cssmodal:show",t.activeElement)},unsetActive:function(e){t.activeElement&&(t.removeClass(t.activeElement,"is-active"),t.trigger("cssmodal:hide",t.activeElement),t.activeElement.setAttribute("aria-hidden","true"),t.removeFocus(),e&&t.stackModal(t.activeElement),!e&&t.stackedElements.length>0&&t.unstackModal(),t.activeElement=null)},stackModal:function(e){t.addClass(e,"is-stacked"),t.stackedElements.push(t.activeElement)},unstackModal:function(){var e=t.stackedElements.length,a=t.stackedElements[e-1];t.removeClass(a,"is-stacked"),window.location.hash=a.id,t.stackedElements.splice(e-1,1)},mainHandler:function(){var e,a=window.location.hash.replace("#",""),n=document.getElementById(a);n?(e=n.children[0],e&&e.className.match(/modal-inner/)&&(t.addClass(document.documentElement,"has-overlay"),t.unsetActive(!0),t.setActive(n))):(t.removeClass(document.documentElement,"has-overlay"),t.unsetActive())}};t.on("keyup",document,function(e){var a=window.location.hash.replace("#","");if(""!==a&&"!"!==a&&27===e.keyCode){if(window.location.hash="!",t.lastActive)return!1;t.removeFocus()}},!1),t.on("hashchange",window,t.mainHandler),t.on("load",window,t.mainHandler),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=t:"function"==typeof define&&define.amd?define([],function(){return t}):"object"==typeof e&&"object"==typeof e.document&&(e.CSSModal=t)}(window);